var css3; css3 = "" === document.createElement("detect").style.backgroundSize ? !0 : !1, function (a) { a.fn.imageHandler = function (b) { function e() { d -= 1, 0 == d && c.afterAll.call(this) } var c = a.extend({ mode: "fill-top", loader: null, dummy: null, rtl: !1, lazy: !1, distance: 200, fade: 1e3, retina: !1, retina_suffix: "@2x", before: function () { }, afterEach: function () { }, afterAll: function () { }, onError: function () { } }, b); c.before.call(this); var d = a(this).length; return this.each(function () { function q() { 1 == c.rtl ? b.css({ width: "100%", height: "auto", right: "0", top: "0", left: "auto", visibility: "visible", marginTop: "", marginLeft: "", marginRight: "" }) : b.css({ width: "100%", height: "auto", top: "0", left: "0", right: "auto", visibility: "visible", marginTop: "", marginLeft: "", marginRight: "" }) } function r() { b.css({ width: "100%", height: "auto" }), j = b.height(), k = i / j, 1 == c.rtl ? b.css({ top: "50%", right: "0", left: "auto", marginTop: -j / 2, visibility: "visible", marginLeft: "", marginRight: "" }) : b.css({ top: "50%", left: "0", right: "auto", marginTop: -j / 2, visibility: "visible", marginLeft: "", marginRight: "" }) } function s() { b.css({ width: "100%", height: "auto" }), j = b.height(), k = i / j, 1 == c.rtl ? b.css({ bottom: "0", right: "0", left: "auto", visibility: "visible", top: "auto", marginLeft: "", marginRight: "" }) : b.css({ bottom: "0", left: "0", right: "auto", visibility: "visible", top: "auto", marginLeft: "", marginRight: "" }) } function t() { b.css({ width: "auto", height: "100%" }), i = b.width(), 1 == c.rtl ? b.css({ right: "50%", marginRight: -i / 2, visibility: "visible", left: "auto", marginLeft: "", top: "auto", marginTop: "" }) : b.css({ left: "50%", marginLeft: -i / 2, visibility: "visible", right: "auto", marginRight: "", top: "auto", marginTop: "" }) } function u() { n > k ? q() : k > n ? t() : k == n && t() } function v() { n > k ? r() : k > n ? t() : k == n && t() } function w() { n > k ? s() : k > n ? t() : k == n && t() } function x() { n > k ? t() : k > n ? r() : k == n && q() } function y() { h.addClass("handler-error"), b.css("width", "100%"), b.css("height", "100%"), b.css("visibility", "visible"), b.next(".handler-loader").hide().remove(), b.css("opacity", ""), null != c.dummy && 0 == b.siblings(".handler-dummy").length && (b.after('<img src="' + c.dummy + '" class="handler-dummy" style="position:absolute;top:50%;border:0;z-index:2;visibility:hidden;" />'), b.next(".handler-dummy").one("load", function () { var b = a(this).width(), d = a(this).height(); 1 == c.rtl ? a(this).css({ width: b, height: d, right: "50%", marginTop: -d / 2, marginRight: -b / 2, visibility: "visible" }) : a(this).css({ width: b, height: d, left: "50%", marginTop: -d / 2, marginLeft: -b / 2, visibility: "visible" }) }).each(function () { this.complete && a(this).load() }), b.hide()); var d = h; c.onError.call(this, d), b.unbind() } function z(d) { b = b.filter(function () { return 0 === b.parent(".handler-error").length }), b.one("load", function () { i = b.width(), j = b.height(), k = i / j, l = h.width(), m = h.height(), n = l / m, d(), b.next(".handler-loader").hide().remove(), h.hasClass("handler-loaded") || b.animate({ opacity: 1 }, c.fade, function () { b.css("opacity", "") }), e(), h.removeClass("handler-loading").addClass("handler-loaded"); var a = h; c.afterEach.call(this, a) }).each(function () { this.complete && a(this).load() }), b.error(function () { e(), y(), h.removeClass("handler-loading") }) } function A() { h.css({ backgroundSize: "cover", backgroundPosition: "top center" }) } function B() { h.css({ backgroundSize: "cover", backgroundPosition: "center center" }) } function C() { h.css({ backgroundSize: "cover", backgroundPosition: "bottom center" }) } function D() { h.css({ backgroundSize: "contain", backgroundPosition: "center center" }) } function E(d) { var f = b.attr("src"); h.not(".handler-loaded").css({ opacity: 1, transition: "none", backgroundRepeat: "no-repeat" }), b = b.filter(function () { return 0 === b.parent(".handler-error").length }), b.one("load", function () { b.hide(), d(), b.next(".handler-loader").hide().remove(), h.not(".handler-loaded").css({ opacity: 0, backgroundImage: 'url("' + f + '")' }), h.not(".handler-loaded").animate({ opacity: 1 }, c.fade, function () { h.css({ opacity: "", transition: "" }) }), e(), h.removeClass("handler-loading").addClass("handler-loaded"); var a = h; c.afterEach.call(this, a) }).each(function () { this.complete && a(this).load() }), b.error(function () { e(), y(), h.removeClass("handler-loading").css({ opacity: 1 }) }) } function F() { void 0 == b.attr("data-mode") ? "fill-top" == c.mode ? 1 == css3 ? E(A) : z(u) : "fill-middle" == c.mode ? 1 == css3 ? E(B) : z(v) : "fill-bottom" == c.mode ? 1 == css3 ? E(C) : z(w) : "fit" == c.mode && (1 == css3 ? E(D) : z(x)) : "fill-top" == b.attr("data-mode") ? 1 == css3 ? E(A) : z(u) : "fill-middle" == b.attr("data-mode") ? 1 == css3 ? E(B) : z(v) : "fill-bottom" == b.attr("data-mode") ? 1 == css3 ? E(C) : z(w) : "fit" == b.attr("data-mode") && (1 == css3 ? E(D) : z(x)) } function G() { 1 == c.retina ? K() ? 1 == c.lazy ? N() : M() : L() ? 1 == c.lazy ? N() : M() : 1 == c.lazy ? O() : H() : 1 == c.lazy ? O() : H() } function H() { b.attr("src", f), b.removeAttr("data-src"), F() } function I() { var a = f.substr(-4), d = f.substr(0, f.length - 4); d += c.retina_suffix + a, b.attr("src", d), b.removeAttr("data-src"), F(), b.error(function () { b.css("opacity", "0"), h.removeClass("handler-error"), H(), F() }) } function J() { b.attr("src", g), b.removeAttr("data-src"), b.removeAttr("data-retina"), F(), b.error(function () { b.css("opacity", "0"), h.removeClass("handler-error"), H(), F() }) } function K() { return window.matchMedia && (window.matchMedia("only screen and (min-resolution: 124dpi), only screen and (min-resolution: 1.3dppx), only screen and (min-resolution: 48.8dpcm)").matches || window.matchMedia("only screen and (-webkit-min-device-pixel-ratio: 1.3), only screen and (-o-min-device-pixel-ratio: 2.6/2), only screen and (min--moz-device-pixel-ratio: 1.3), only screen and (min-device-pixel-ratio: 1.3)").matches) || window.devicePixelRatio && window.devicePixelRatio > 1.3 } function L() { return (window.matchMedia && (window.matchMedia("only screen and (min-resolution: 192dpi), only screen and (min-resolution: 2dppx), only screen and (min-resolution: 75.6dpcm)").matches || window.matchMedia("only screen and (-webkit-min-device-pixel-ratio: 2), only screen and (-o-min-device-pixel-ratio: 2/1), only screen and (min--moz-device-pixel-ratio: 2), only screen and (min-device-pixel-ratio: 2)").matches) || window.devicePixelRatio && window.devicePixelRatio > 2) && /(iPad|iPhone|iPod)/g.test(navigator.userAgent) } function M() { void 0 != g ? J() : I() } function N() { a(window).scrollTop() > o - p - c.distance && M(), a(window).resize(function () { p = a(window).height() }), a(window).scroll(function () { a(window).scrollTop() > o - p - c.distance && void 0 == b.attr("src") && M() }) } function O() { a(window).scrollTop() > o - p - c.distance && H(), a(window).resize(function () { p = a(window).height() }), a(window).scroll(function () { a(window).scrollTop() > o - p - c.distance && void 0 == b.attr("src") && H() }) } function P() { o = h.offset().top, p = a(window).height(), void 0 != f && h.hasClass("handler-loading") ? G() : F() } function Q() { if (0 != css3) { var a = h.css("transition-duration"); if (void 0 != a) if ("0s" == a) { h.css({ transition: "inherit" }), a = h.css("transition-duration"), a = a.match(/[0-9]+/g); var b = Math.max.apply(Math, a); b > 0 ? (b = 100 * b, setTimeout(function () { P() }, b + 50)) : P(), h.css({ transition: "" }) } else { a = a.match(/[0-9]+/g); var b = Math.max.apply(Math, a); b > 0 ? (b = 100 * b, setTimeout(function () { P() }, b + 50)) : P() } } else P() } var h, i, j, k, l, m, n, o, b = a(this), d = b.attr("class"), f = b.attr("data-src"), g = b.attr("data-retina"), p = a(window).height(); b = b.not(".handler-loading, .handler-loaded, .handler-error"), b.css({ position: "absolute", display: "block", visibility: "hidden", opacity: 0, border: "none", transition: "none", zIndex: 1 }), b.removeClass(), b.wrap('<div class="' + d + ' handler-loading" style="padding:0;overflow:hidden;-webkit-backface-visibility:hidden;backface-visibility:hidden;"></div>'), null != c.loader && (b.after('<img src="' + c.loader + '" class="handler-loader" style="position:absolute;top:50%;border:0;z-index:2;visibility:hidden;" />'), b.next(".handler-loader").one("load", function () { var b = a(this).width(), d = a(this).height(); 1 == c.rtl ? a(this).css({ width: b, height: d, right: "50%", marginTop: -d / 2, marginRight: -b / 2, visibility: "visible" }) : a(this).css({ width: b, height: d, left: "50%", marginTop: -d / 2, marginLeft: -b / 2, visibility: "visible" }) }).each(function () { this.complete && a(this).load() })), b = a(this), h = b.parent(), o = h.offset().top, "absolute" != h.css("position") && "fixed" != h.css("position") && h.css("position", "relative"), void 0 != f ? G() : F(), a(window).resize(function () { Q() }), b.on("reHandle", function () { Q() }) }) } }(jQuery);